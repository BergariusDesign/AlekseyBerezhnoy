<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aleksej Berezhnoj | Motion Design</title>
	
	<meta property="og:type" content="website">
<meta property="og:url" content="https://bergariusdesign.github.io/AlekseyBerezhnoy/">
<meta property="og:title" content="Aleksej Berezhnoj | Digital Alchemy">
<meta property="og:description" content="Motion Design & AI Cinematic Portfolio 2026. Исследуйте мир цифровой алхимии.">
<meta property="og:image" content="https://bergariusdesign.github.io/AlekseyBerezhnoy/images/preview.jpg">

<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:title" content="Aleksej Berezhnoj | Digital Alchemy">
<meta property="twitter:description" content="Motion Design & AI Cinematic Portfolio 2026.">
<meta property="twitter:image" content="https://bergariusdesign.github.io/AlekseyBerezhnoy/images/preview.jpg">
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
	
    <style>
	html, body {
    overflow-x: hidden;
    position: relative;
    width: 100%;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* Блокировка скролла страницы при открытом окне */
body.modal-open {
    overflow: hidden !important;
    /* Убрали position: fixed, чтобы страница не улетала вверх */
}

/* Лайтбокс: картинка всегда вписывается в экран */
.lightbox-content {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 10px;
}

#lightbox-compare-box {
    display: none;
    width: 100%;
    max-width: 100%;
    aspect-ratio: 16/9;
    max-height: 70vh; /* Ограничиваем высоту, чтобы не был огромным */
    margin: auto;
    position: relative;
    overflow: hidden;
    background: #000;
}

*, *:before, *:after {
    box-sizing: inherit;
}
	#neural-percent {
    font-variant-numeric: tabular-nums; /* Чтобы цифры не "прыгали" при смене ширины */
    font-weight: 800;
}
	/* Стили для отдельного блока шоурилла */
.showreel-footer-block {
    margin-top: 120px;
    padding: 60px 0;
    border-top: 1px solid var(--glass-border);
    text-align: center;
}

.showreel-mini-title {
    font-family: var(--font-tech);
    color: var(--accent-glow);
    font-size: 12px;
    letter-spacing: 4px;
    text-transform: uppercase;
    margin-bottom: 30px;
    opacity: 0.6;
}

.showreel-player-container {
    max-width: 900px;
    margin: 0 auto;
    border-radius: 12px;
    overflow: hidden;
    border: 1px solid var(--glass-border);
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
    transition: 0.5s;
}

.showreel-player-container:hover {
    border-color: rgba(0, 240, 255, 0.4);
    box-shadow: 0 0 50px rgba(0, 240, 255, 0.1);
}

.showreel-video {
    width: 100%;
    display: block;
    aspect-ratio: 16/9;
    object-fit: cover;
    background: #000;
}
        /* --- СТИЛИ (CSS) --- */
        :root {
            --bg-deep: #050507; 
            --glass-bg: rgba(255, 255, 255, 0.03); 
            --glass-border: rgba(255, 255, 255, 0.08); 
            --accent-glow: #00f0ff; /* Неоновый Циан */
            --text-main: #ffffff;
            --text-muted: #8b9bb4;
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-tech: 'Courier New', Courier, monospace;
        }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: var(--font-main);
            margin: 0; padding: 0; overflow-x: hidden;
            scroll-behavior: smooth;
        }

        #neural-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(circle at center, #0b1023 0%, #000000 100%); }

        .wrapper { max-width: 1400px; margin: 0 auto; padding: 40px 20px; position: relative; z-index: 1; }
		
		#preloader {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #000; z-index: 10000;
    display: flex; justify-content: center; align-items: center;
    transition: opacity 0.8s ease, visibility 0.8s ease;
	}
	/* ДОБАВИТЬ ЭТОТ БЛОК ОБЯЗАТЕЛЬНО */
        #preloader.hide {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
.loader-text {
    font-family: var(--font-tech);
    color: var(--accent-glow);
    font-size: 14px;
    letter-spacing: 3px;
    animation: blink 1s infinite;
}
@keyframes blink { 50% { opacity: 0.5; } }
		
		.scroll-progress {
    position: fixed;
    top: 0; left: 0;
    height: 3px;
    background: var(--accent-glow);
    width: 0%;
    z-index: 10000;
    box-shadow: 0 0 10px var(--accent-glow);
    transition: width 0.1s;
}

        /* HEADER */
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 80px; }
        
        .logo { 
            font-weight: 700; font-size: 24px; letter-spacing: -0.5px; 
            background: linear-gradient(90deg, #fff, var(--text-muted)); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; cursor: pointer; 
        }

        .header-right { display: flex; align-items: center; gap: 30px; }

        .status-container { display: flex; align-items: center; }
        .status-dot { height: 8px; width: 8px; background-color: var(--accent-glow); border-radius: 50%; display: inline-block; box-shadow: 0 0 12px var(--accent-glow); margin-right: 8px; }
        .status-text { font-size: 14px; color: var(--text-muted); font-weight: 500; font-family: var(--font-tech); text-transform: uppercase; letter-spacing: 1px;}

        /* ЯЗЫКОВЫЕ КНОПКИ */
        .lang-switch { display: flex; gap: 10px; }
        .lang-btn {
            background: transparent; border: 1px solid var(--glass-border);
            color: var(--text-muted); padding: 5px 12px; border-radius: 20px;
            font-family: var(--font-tech); font-size: 12px; cursor: pointer; transition: 0.3s;
        }
        .lang-btn:hover { border-color: var(--accent-glow); color: #fff; }
        .lang-btn.active {
            background: rgba(0, 240, 255, 0.1); border-color: var(--accent-glow);
            color: var(--accent-glow); box-shadow: 0 0 10px rgba(0, 240, 255, 0.2);
        }

        /* HERO & GRID */
        #main-view { display: block; animation: fadeIn 0.8s ease forwards; }
        .hero { margin-bottom: 120px; position: relative; }
        h1 { 
            font-size: clamp(48px, 9vw, 130px); line-height: 0.95; margin: 0; font-weight: 800; letter-spacing: -0.04em; 
            background: linear-gradient(180deg, #ffffff 0%, #666 100%); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; 
        }
        .hero p { 
            font-size: 18px; color: var(--text-muted); max-width: 480px; margin-top: 30px; line-height: 1.6; 
            border-left: 2px solid var(--accent-glow); padding-left: 20px; 
        }

        .grid { display: grid; grid-template-columns: repeat(12, 1fr); grid-auto-rows: minmax(300px, auto); gap: 24px; }
        .card { 
            background: var(--glass-bg); border: 1px solid var(--glass-border); 
            border-radius: 24px; overflow: hidden; position: relative; backdrop-filter: blur(12px); 
            transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1), border-color 0.3s; 
            display: flex; flex-direction: column; justify-content: flex-end; cursor: pointer; 
        }
        .card:hover { transform: translateY(-5px) scale(1.01); border-color: rgba(255, 255, 255, 0.3); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        .card video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; opacity: 0.6; transition: opacity 0.5s ease; mix-blend-mode: screen; pointer-events: none; }
        .card:hover video { opacity: 1; mix-blend-mode: normal; }
        .card-content { position: relative; z-index: 2; padding: 30px; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); }
        .card-title { font-size: 24px; margin: 0 0 5px 0; color: #fff; pointer-events: none;}
        .card-tag { 
            font-size: 12px; text-transform: uppercase; letter-spacing: 1px; font-family: var(--font-tech);
            color: var(--accent-glow); border: 1px solid rgba(0, 240, 255, 0.3); 
            padding: 4px 10px; border-radius: 20px; display: inline-block; pointer-events: none; 
        }
        .col-8 { grid-column: span 8; height: 500px; }
        .col-4 { grid-column: span 4; height: 500px; }
        .col-6 { grid-column: span 6; height: 350px; }
        @media (max-width: 1024px) { .col-8, .col-4, .col-6 { grid-column: span 12; height: 400px; } h1 { font-size: 60px; } }

        /* --- СТРАНИЦА ПРОЕКТА --- */
        #project-view { display: none; opacity: 0; padding-top: 20px; }
        
        .back-btn {
            background: none; border: 1px solid var(--glass-border);
            color: var(--text-muted); padding: 10px 20px; border-radius: 30px;
            cursor: pointer; transition: 0.3s; margin-bottom: 40px;
            display: inline-flex; align-items: center; gap: 10px; font-size: 14px; font-family: var(--font-tech);
        }
        .back-btn:hover { border-color: var(--accent-glow); color: #fff; background: rgba(255,255,255,0.05); }

        .project-header { margin-bottom: 60px; }
        .project-header h2 { font-size: clamp(32px, 5vw, 60px); margin: 0 0 20px 0; }
        .project-meta { display: flex; gap: 20px; margin-bottom: 60px; color: var(--text-muted); font-family: var(--font-tech); font-size: 12px;}
        
        /* ПЛЕЕР */
        .video-wrapper {
            position: relative; padding: 1px;
            background: linear-gradient(90deg, transparent, var(--accent-glow), transparent);
            margin-bottom: 80px; border-radius: 4px;
        }
        .main-project-video {
            width: 100%; border-radius: 4px; border: none;
            margin-bottom: 0; aspect-ratio: 16/9; object-fit: cover; background: #000;
        }

        .return-overlay-btn {
            position: absolute; top: 20px; right: 20px;
            background: rgba(0, 0, 0, 0.8); border: 1px solid var(--accent-glow);
            color: #fff; padding: 10px 20px; border-radius: 30px;
            cursor: pointer; z-index: 50;
            display: flex; align-items: center; gap: 10px;
            font-family: var(--font-tech); font-size: 12px;
            opacity: 0; visibility: hidden; pointer-events: none;
            transition: 0.3s; box-shadow: 0 0 15px rgba(0, 240, 255, 0.2);
        }
        .return-overlay-btn.active { opacity: 1; visibility: visible; pointer-events: all; }
        .return-overlay-btn:hover { background: var(--accent-glow); color: #000; box-shadow: 0 0 30px rgba(0, 240, 255, 0.5); }

        /* --- ТАЙМЛАЙН --- */
        .process-section { position: relative; max-width: 1000px; margin: 0 auto 100px auto; padding: 20px 0; }
        .process-section::before {
            content: ''; position: absolute; top: 0; bottom: 0; left: 50%; width: 2px;
            background: linear-gradient(to bottom, transparent, var(--accent-glow), transparent);
            transform: translateX(-50%); z-index: 0; opacity: 0.3;
        }
        .timeline-step { display: flex; justify-content: space-between; align-items: center; margin-bottom: 100px; position: relative; z-index: 1; }
        .timeline-step:nth-child(even) { flex-direction: row-reverse; }
        .step-text { width: 42%; padding: 20px; }
        .step-text h3 {
            font-size: 14px; color: var(--accent-glow); letter-spacing: 2px; text-transform: uppercase;
            margin-bottom: 10px; display: flex; align-items: center; gap: 10px; font-family: var(--font-tech);
        }
        .step-number {
            font-size: 80px; font-weight: 900; color: rgba(255,255,255,0.03);
            position: absolute; margin-top: -60px; z-index: -1; font-family: 'Inter', sans-serif;
        }
        .step-text h4 { font-size: 24px; margin: 0 0 15px 0; color: #fff; }
        .step-text p { color: var(--text-muted); line-height: 1.6; font-size: 15px; }
        .step-visual { width: 45%; display: flex; flex-direction: column; gap: 20px; } /* Добавлено для стэка рамок */
        
        /* 3D КАРТОЧКА */
        .process-card {
            height: 250px; width: 100%; position: relative;
            border-radius: 12px; overflow: hidden;
            border: 1px solid var(--glass-border);
            background: #000;
            transform-style: preserve-3d; transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            cursor: zoom-in;
        }
        .process-img { 
            width: 100%; height: 100%; object-fit: cover; /* Изменено с cover на contain, чтобы избежать зума */
            opacity: 0.8; transition: 0.5s; filter: grayscale(100%); pointer-events: none;
            background: #080808; /* Темный фон для contain */
        }
        .process-card:hover { border-color: var(--accent-glow); box-shadow: 0 0 50px rgba(0, 240, 255, 0.3); z-index: 100; }
        .process-card:hover .process-img { opacity: 1; filter: grayscale(0%); }

        /* Локальный кружочек для каждой рамки */
        .frame-indicator {
            position: absolute; left: 50%; width: 10px; height: 10px;
            background: var(--bg-deep); border: 2px solid var(--accent-glow);
            border-radius: 50%; transform: translateX(-50%);
            box-shadow: 0 0 10px var(--accent-glow); z-index: 5;
        }

        /* --- СЛАЙДЕР ДО/ПОСЛЕ --- */
        .compare-container { position: relative; width: 100%; height: 100%; overflow: hidden; }
        .compare-img {
            position: absolute;
            top: 0;
            left: 0;
            height: 100% !important;
            width: 100%; /* Убрали 100% !important */
            object-fit: contain !important; 
            pointer-events: none;
            display: block;
        }
        .img-after-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            border-right: 2px solid var(--accent-glow);
            z-index: 2;
        }
        .img-after-wrapper .compare-img { 
            width: 100%; 
            max-width: none !important; /* Критично: запрещает картинке сжиматься вместе с оберткой */
        }
        .label {
            position: absolute; top: 20px; font-family: var(--font-tech); font-size: 10px; padding: 4px 8px;
            background: rgba(0,0,0,0.6); border: 1px solid var(--glass-border); border-radius: 4px; color: #fff; pointer-events: none; z-index: 10;
        }
        .label-before { right: 20px; }
        .label-after { left: 20px; color: var(--accent-glow); border-color: var(--accent-glow); }
        .timeline-dot {
            position: absolute; left: 50%; width: 12px; height: 12px;
            background: #050507; border: 2px solid var(--accent-glow);
            border-radius: 50%; transform: translateX(-50%);
            box-shadow: 0 0 15px var(--accent-glow);
        }
		
        /* --- ВЕРТИКАЛЬНАЯ СТОПКА (ДРУГ ПОД ДРУГОМ) --- */
        .vertical-stack {
            display: flex;
            flex-direction: column;
            gap: 25px; /* Отступ между элементами */
            width: 100%;
        }
        .vertical-stack .process-card {
            height: 280px; /* Фиксированная высота для красоты */
            width: 100%;
        }
		
        /* --- РЕЖИМ РЕКОНСТРУКЦИИ (NEURAL LOCK) --- */
        .card.locked {
            pointer-events: none; /* Отключаем клики */
            user-select: none;
            overflow: hidden;
        }

        /* Темная вуаль */
        .locked-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(5, 5, 7, 0.85);
            backdrop-filter: blur(8px);
            z-index: 50;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            border: 1px solid rgba(0, 240, 255, 0.2);
        }

        /* Сканирующий луч (Нейронное воздействие) */
        .neural-scan-line {
            position: absolute; top: 0; left: 0; width: 100%; height: 5px;
            background: linear-gradient(90deg, transparent, var(--accent-glow), transparent);
            box-shadow: 0 0 15px var(--accent-glow);
            opacity: 0.7;
            animation: scanMove 3s cubic-bezier(0.4, 0, 0.2, 1) infinite;
        }

        /* Глитч-текст */
        .lock-status {
            font-family: var(--font-tech); font-size: 14px; letter-spacing: 2px;
            color: var(--accent-glow); text-transform: uppercase;
            margin-top: 15px;
            text-shadow: 0 0 5px var(--accent-glow);
            animation: textPulse 2s ease-in-out infinite;
        }

        /* Иконка замка с пульсацией */
        .lock-icon-svg {
            width: 40px; height: 40px; fill: var(--text-muted);
            animation: lockFloat 3s ease-in-out infinite;
        }

        @keyframes scanMove {
            0% { top: -10%; opacity: 0; }
            50% { opacity: 1; }
            100% { top: 110%; opacity: 0; }
        }
        @keyframes lockFloat {
            0%, 100% { transform: translateY(0); opacity: 0.5; }
            50% { transform: translateY(-10px); opacity: 1; filter: drop-shadow(0 0 10px var(--accent-glow)); }
        }
        @keyframes textPulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; text-shadow: 0 0 15px var(--accent-glow); } }

        /* --- ПРОЧЕЕ --- */
        .scroll-to-top {
            position: fixed; bottom: 40px; right: 40px; width: 50px; height: 50px;
            background: rgba(5, 5, 7, 0.8); border: 1px solid var(--accent-glow); border-radius: 50%;
            display: flex; justify-content: center; align-items: center; cursor: pointer;
            z-index: 900; opacity: 0; visibility: hidden; transition: all 0.3s ease;
            backdrop-filter: blur(5px); box-shadow: 0 0 15px rgba(0, 240, 255, 0.2);
        }
        .scroll-to-top.show { opacity: 1; visibility: visible; }
        .scroll-to-top:hover { transform: translateY(-5px); box-shadow: 0 0 25px rgba(0, 240, 255, 0.6); background: rgba(0, 240, 255, 0.1); }
        .scroll-to-top svg { width: 24px; height: 24px; fill: none; stroke: var(--accent-glow); stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }

        .contact-float {
            position: fixed; bottom: 40px; left: 40px; height: 50px;
            background: rgba(5, 5, 7, 0.8); border: 1px solid var(--accent-glow); border-radius: 30px; 
            display: flex; align-items: center; justify-content: center; padding: 0 25px; gap: 12px;
            cursor: pointer; z-index: 900; color: #fff; text-decoration: none;
            backdrop-filter: blur(5px); box-shadow: 0 0 15px rgba(0, 240, 255, 0.2);
            transition: all 0.3s ease; font-family: var(--font-tech); font-size: 14px; letter-spacing: 1px;
        }
        .contact-float:hover { transform: translateY(-5px); box-shadow: 0 0 30px rgba(0, 240, 255, 0.5); background: rgba(0, 240, 255, 0.1); color: var(--accent-glow); }
        .contact-float svg { width: 20px; height: 20px; fill: currentColor; }

        /* --- МОДАЛЬНЫЕ ОКНА --- */
        .modal {
            display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.95); backdrop-filter: blur(5px);
            justify-content: center; align-items: center; opacity: 0; transition: opacity 0.3s;
        }
        .modal.active { display: flex; opacity: 1; }
        .modal-close { position: absolute; top: 30px; right: 40px; color: #fff; font-size: 40px; font-weight: bold; cursor: pointer; transition: 0.3s; z-index: 1000;}
        .modal-close:hover { color: var(--accent-glow); }

        .lightbox-content { display: flex; flex-direction: column; align-items: center; width: 100%; height: 100%; justify-content: center; }
        .lightbox-img { max-width: 95%; max-height: 85%; border-radius: 4px; box-shadow: 0 0 50px rgba(0, 240, 255, 0.2); border: 1px solid var(--accent-glow); transform: scale(0.9); transition: transform 0.3s; margin-bottom: 20px; }
        .modal.active .lightbox-img { transform: scale(1); }

        /* ЛАЙТБОКС СЛАЙДЕР */
        #lightbox-compare-box {
            width: 90%; height: 85%; max-width: 1400px;
            border: 1px solid var(--accent-glow); border-radius: 4px; box-shadow: 0 0 50px rgba(0, 240, 255, 0.2); display: none;
        }
        #lightbox-compare-box .compare-img { width: 100%; height: 100%; object-fit: cover; }
        #lightbox-compare-box .img-after-wrapper .compare-img { width: 100%; max-width: none; height: 100%; }

        .lightbox-play-btn {
            background: rgba(0, 0, 0, 0.7); border: 1px solid var(--accent-glow); color: #fff; padding: 12px 25px; border-radius: 30px; cursor: pointer;
            font-family: var(--font-tech); font-size: 14px; display: flex; align-items: center; gap: 10px; transition: 0.3s; box-shadow: 0 0 20px rgba(0, 240, 255, 0.2);
        }
        .lightbox-play-btn:hover { background: var(--accent-glow); color: #000; box-shadow: 0 0 40px rgba(0, 240, 255, 0.6); transform: scale(1.05); }
        .lightbox-play-btn svg { width: 16px; height: 16px; fill: currentColor; }

        .contact-modal-box {
            background: rgba(10, 10, 15, 0.9); border: 1px solid var(--glass-border); padding: 40px; border-radius: 20px;
            width: 100%; max-width: 500px; box-shadow: 0 0 50px rgba(0, 0, 0, 0.8); position: relative;
        }
        .contact-title { font-size: 24px; margin: 0 0 30px 0; color: #fff; text-align: center; font-family: var(--font-tech); }
        .email-copy-row { display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 1px solid var(--glass-border); }
        .my-email { font-family: var(--font-tech); color: var(--accent-glow); font-size: 14px; }
        .copy-btn { background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 12px; text-transform: uppercase; transition: 0.3s; }
        .copy-btn:hover { color: #fff; }
        .contact-textarea {
            width: 100%; height: 120px; background: rgba(255,255,255,0.05); border: 1px solid var(--glass-border);
            border-radius: 8px; color: #fff; padding: 15px; font-family: var(--font-main); font-size: 14px; resize: none; margin-bottom: 20px; outline: none; box-sizing: border-box;
        }
        .contact-textarea:focus { border-color: var(--accent-glow); }
        .send-btn {
            width: 100%; padding: 15px; background: var(--accent-glow); border: none; border-radius: 8px;
            color: #000; font-weight: 700; cursor: pointer; font-family: var(--font-tech); font-size: 14px; letter-spacing: 1px; transition: 0.3s;
        }
        .send-btn:hover { box-shadow: 0 0 20px var(--accent-glow); transform: translateY(-2px); }
        .send-btn:disabled { background: #333; color: #666; cursor: not-allowed; box-shadow: none; transform: none; }

        /* --- СОЦСЕТИ И АДМИНКА --- */
        .social-icon.vk:hover { color: #0077FF; filter: drop-shadow(0 0 10px #0077FF); transform: translateY(-3px) scale(1.1); }
        
        /* TELEGRAM (СИНИЙ) */
        .social-icon.tg:hover { color: #229ED9; filter: drop-shadow(0 0 10px #229ED9); transform: translateY(-3px) scale(1.1); }
        
        .social-icon.admin-lock:hover { color: #fff; filter: drop-shadow(0 0 10px #fff); transform: translateY(-3px) scale(1.1); }
        
        /* Стили для админ-панели */
        .admin-input-row { display: flex; gap: 10px; margin-bottom: 20px; }
        .admin-input { flex: 1; padding: 10px; background: rgba(255,255,255,0.1); border: 1px solid var(--glass-border); color: #fff; border-radius: 8px; font-family: var(--font-tech); outline: none;}
        .admin-stats-list { max-height: 300px; overflow-y: auto; text-align: left; border-top: 1px solid var(--glass-border); padding-top: 20px; }
        .stat-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-family: var(--font-tech); font-size: 14px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 5px; }
        .stat-name { color: var(--text-muted); }
        .stat-val { color: var(--accent-glow); font-weight: bold; }

        /* --- АДАПТИВНОСТЬ (МОБИЛЬНАЯ ВЕРСИЯ) --- */
    @media (max-width: 768px) {
        .timeline-step { 
            flex-direction: column !important; 
            align-items: flex-start !important;
            padding-left: 0 !important; 
            margin-bottom: 50px !important;
        }
		
		header {
    flex-direction: column; /* Ставим логотип и кнопки друг под другом */
    gap: 15px;
    margin-bottom: 40px;
    align-items: center;
    text-align: center;
}

.logo {
    font-size: 20px !important; /* Немного уменьшаем логотип */
}

.header-right {
    gap: 15px; /* Уменьшаем расстояние между статусом и кнопками RU/EN */
    width: 100%;
    justify-content: center;
}

        .step-text, .step-visual { 
            width: 100% !important; 
            padding: 0 10px !important;
        }

        .step-text p { font-size: 16px !important; line-height: 1.5; }

        .grid { display: flex; flex-direction: column; gap: 20px; }
        .col-8, .col-4, .col-6 { width: 100% !important; height: auto; min-height: 250px; }
        .wrapper { padding: 15px; }

        h1 { font-size: 36px !important; }
        .project-header h2 { font-size: 24px !important; }
        
        /* ЛАЙТБОКС */
        .lightbox-img { max-height: 80vh !important; width: auto !important; }
        
        #lightbox-compare-box {
            width: 100% !important;
            max-width: 100vw !important;
            height: 100% !important;
            aspect-ratio: 16/9;
            max-height: 60vh !important; /* Чтобы точно влезло в вертикальный экран */
        }

        /* УБИРАЕМ ТЯНУЩУЮСЯ КАРТИНКУ: Удаляем !important у ширины */
        .compare-img {
            display: block;
            width: 100%; 
            height: 100% !important;
            object-fit: contain !important;
            pointer-events: none;
        }
        
        .modal-close { top: 10px; right: 15px; font-size: 35px; }
        footer { flex-direction: column-reverse; gap: 20px; text-align: center; }
    }
    
   

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        footer { margin-top: 100px; border-top: 1px solid var(--glass-border); padding: 40px 0; color: var(--text-muted); font-size: 14px; display: flex; justify-content: space-between; align-items: center; }
        .social-links { display: flex; gap: 25px; align-items: center; }
        .social-icon { color: var(--text-muted); transition: all 0.3s ease; display: flex; align-items: center; text-decoration: none; cursor: pointer;}
        .social-icon svg { width: 24px; height: 24px; fill: currentColor; }
		
		/* Кнопка для YouTube */
        .yt-button {
            display: inline-flex; align-items: center; gap: 10px;
            padding: 6px 14px; /* Чуть компактнее */
            background: rgba(255, 0, 0, 0.1); 
            border: 1px solid rgba(255, 0, 0, 0.3);
            border-radius: 20px; color: #fff; text-decoration: none;
            font-family: var(--font-tech); font-size: 11px;
            transition: all 0.3s ease; margin-bottom: 15px; /* Отступ снизу до заголовка */
            width: fit-content;
        }
        .yt-button:hover {
            background: rgba(255, 0, 0, 0.8); border-color: #ff0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.5); transform: translateY(-2px); color: #fff;
        }
        .yt-icon { width: 14px; height: 14px; fill: currentColor; }
    </style>
</head>
<body>
<div id="preloader">
    <div class="loader-text">INITIALIZING...</div>
</div>
    <div class="scroll-progress"></div>
    <canvas id="neural-canvas"></canvas>

    <div class="scroll-to-top" id="scrollTopBtn" onclick="scrollToTop()">
        <svg viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"></polyline></svg>
    </div>

    <div class="contact-float" onclick="toggleContact()">
        <svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
        <span data-i18n="contact-btn">ОБСУДИТЬ ПРОЕКТ</span>
    </div>

    <div id="contact-modal" class="modal">
        <span class="modal-close" onclick="toggleContact()">&times;</span>
        <div class="contact-modal-box">
            <h2 class="contact-title" data-i18n="contact-title">СВЯЗАТЬСЯ СО МНОЙ</h2>
            <div class="email-copy-row">
                <span class="my-email" id="display-email">...</span>
                <button class="copy-btn" onclick="copyEmail()" data-i18n="copy-btn">КОПИРОВАТЬ</button>
            </div>
            <textarea class="contact-textarea" id="contact-msg" placeholder="Опишите вашу задачу..." data-i18n-placeholder="contact-placeholder"></textarea>
            <button class="send-btn" id="send-btn" onclick="sendToMail()" data-i18n="send-btn">ОТПРАВИТЬ ПИСЬМО</button>
        </div>
    </div>

    <div id="admin-modal" class="modal">
        <span class="modal-close" onclick="toggleAdmin()">&times;</span>
        <div class="contact-modal-box">
            <h2 class="contact-title">STATISTICS</h2>
            
            <div id="admin-login-view">
                <div class="admin-input-row">
                    <input type="password" id="admin-pass" class="admin-input" placeholder="Enter Password">
                    <button class="send-btn" style="width: auto;" onclick="checkAdminPassword()">LOGIN</button>
                </div>
            </div>

            <div id="admin-stats-view" style="display: none;">
                <div class="admin-stats-list" id="stats-list-container">
                    <div style="text-align: center; color: #666;">Loading data...</div>
                </div>
            </div>
        </div>
    </div>

    <div id="lightbox" class="modal">
        <span class="modal-close" onclick="closeLightbox()">&times;</span>
        <div class="lightbox-content">
            <img class="lightbox-img" id="lightbox-img" src="">
            <div id="lightbox-compare-box" class="compare-container">
                <div class="label label-before">RAW / WIRE</div>
                <img id="lb-img-before" src="" class="compare-img" alt="Before">
                <div id="lb-after-wrapper" class="img-after-wrapper">
                    <div class="label label-after">FINAL</div>
                    <img id="lb-img-after" src="" class="compare-img" alt="After">
                </div>
            </div>
            <button id="lightbox-play-btn" class="lightbox-play-btn">
                <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                <span id="lightbox-play-text" data-i18n="lightbox-play-tpl">СМОТРЕТЬ МОМЕНТ</span>
            </button>
        </div>
    </div>

    <div class="wrapper">
        <header>
            <div class="logo" onclick="showMain()">BERGARIUS.DESIGN</div>
            <div class="header-right">
                <div class="status-container">
                    <span class="status-dot"></span>
                    <span class="status-text" data-i18n="status">Open to create</span>
                </div>
                <div class="lang-switch">
                    <button class="lang-btn active" onclick="setLanguage('ru')">RU</button>
                    <button class="lang-btn" onclick="setLanguage('en')">EN</button>
                </div>
            </div>
        </header>

        <div id="main-view">
            <section class="hero">
                <h1>DIGITAL<br>ALCHEMY</h1>
                <p data-i18n="hero-desc">Соединяю искусство моушн-дизайна с генеративными нейросетями. Создаю визуальные миры, где технология обретает душу.</p>
            </section>
            <div class="grid">
                
                <div class="card col-8" onclick="openProject('magic')">
                    <video autoplay loop muted playsinline><source src="qw.mp4" type="video/mp4"></video>
                    <div class="card-content"> <span class="card-tag">AI Cinematic</span>
                        <h3 class="card-title">The Only Wall is You</h3></div>
                </div>
                
                <div class="card col-4 locked">
                    <div class="locked-overlay">
                        <div class="neural-scan-line"></div>
                        <svg class="lock-icon-svg" viewBox="0 0 24 24"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>
                        <div class="lock-status">AI Avatar... <span id="neural-percent">88.2</span>%</div>
                    </div>
                    <div style="width:100%; height:100%; position: absolute; background: linear-gradient(135deg, #1a1a2e, #16213e);"></div>
                    <div class="card-content">
                        <span class="card-tag">Portfolio</span>
                        <h3 class="card-title">Showreel 2026</h3>
                    </div>
                </div>
                
                <div class="card col-6" onclick="openProject('woman')">
				<video autoplay loop muted playsinline><source src="promo.mp4" type="video/mp4"></video>
                        <div class="card-content"> <span class="card-tag">AI & VFX</span>
                        <h3 class="card-title">Commercial Motion</h3></div>
                </div>
                
                <div class="card col-6" onclick="openProject('watch')">
                    <video autoplay loop muted playsinline><source src="watch.mp4" type="video/mp4"></video>
                    <div class="card-content"><span class="card-tag">Cinema 4D</span><h3 class="card-title">Luxury Watch</h3></div>
                </div>
            </div> <section class="about-section" style="display: none; margin-top: 150px; align-items: center; gap: 50px;">
                <div class="about-text" style="flex: 1;">
                    <h2 style="font-size: 40px; margin-bottom: 20px;">BIO & SKILLS</h2>
                    <p style="color: var(--text-muted); line-height: 1.6;">Алексей Бережной | Digital Alchemy</p>
                </div>
            </section>

            <section class="showreel-footer-block">
                <div class="showreel-mini-title">Process & Motion Showcase (Show Reel)</div>
                <div class="showreel-player-container">
                    <video class="showreel-video" controls poster="images/showreel_cover.jpeg">
                        <source src="showreel.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            </section>
        </div> <div id="project-view">
            <button class="back-btn" onclick="showMain()" data-i18n="back-btn">← ВЕРНУТЬСЯ НАЗАД</button>
            <div class="project-header">
                <h2 id="p-title">Project Name</h2>
                <div class="project-meta">
                    <span id="p-tag">CATEGORY</span> <span>•</span> <span>2026</span>
                </div>
            </div>
            <div class="video-wrapper">
                <video id="p-video" class="main-project-video" controls playsinline></video>
                <div id="return-btn" class="return-overlay-btn" onclick="returnToStep()">
                    <span data-i18n="return-btn">↓ ВЕРНУТЬСЯ К ПРОЦЕССУ</span>
                </div>
            </div>
            <div class="process-section" id="process-container"></div>
        </div> <footer>
            <span data-i18n="copyright">© 2026 Aleksej Berezhnoj</span>
            <div style="font-family: var(--font-tech); font-size: 12px;">MOTION DESIGNER / AI ARTIST</div>
            <div class="social-links">
                <a href="https://t.me/Bergarius" target="_blank" class="social-icon tg" aria-label="Telegram">
                    <svg viewBox="0 0 24 24"><path d="M20.665 3.717l-17.73 6.837c-1.21.486-1.203 1.161-.222 1.462l4.552 1.42 10.532-6.645c.498-.303.953-.14.579.192l-8.533 7.701h-.002l.002.001-.314 4.692c.46 0 .663-.211.921-.46l2.211-2.15 4.599 3.397c.848.467 1.457.227 1.668-.785l3.019-14.228c.309-1.239-.473-1.8-1.282-1.434z"/></svg>
                </a>
                <div class="social-icon admin-lock" onclick="toggleAdmin()">
                    <svg viewBox="0 0 24 24"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>
                </div>
            </div>
        </footer>
    </div>

    <script>
        const myEmail = "bere3hnoya@gmail.com"; 
		
		// --- ПУНКТ 3: СЕКРЕТНОЕ ПОСЛАНИЕ ---
    console.log(
        "%c DIGITAL ALCHEMY %c SYSTEM PROTECTED ",
        "background: #00f0ff; color: #000; font-weight: bold; padding: 5px;",
        "background: #000; color: #00f0ff; padding: 5px; border: 1px solid #00f0ff;"
    );
    console.log("Looking for gold? Keep creating, Aleksej.");
        
        // ОБЪЯВЛЯЕМ ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ДЛЯ РАБОТЫ ВСЕХ ФУНКЦИЙ
        const lightbox = document.getElementById('lightbox');
        const returnBtn = document.getElementById('return-btn');
        const pVideo = document.getElementById('p-video');
        let currentLang = 'ru'; 
        let currentProjectId = null; 
        let activeStepId = null;

        document.getElementById('display-email').innerText = myEmail;

        function sendToMail() {
            const msg = document.getElementById('contact-msg').value;
            const btn = document.getElementById('send-btn');
            if(!msg.trim()) { alert(currentLang === 'ru' ? 'Пожалуйста, напишите сообщение!' : 'Please enter a message!'); return; }
            const originalText = btn.innerText;
            btn.innerText = currentLang === 'ru' ? 'ОТПРАВКА...' : 'SENDING...';
            btn.disabled = true; btn.style.opacity = "0.7";
            fetch(`https://formsubmit.co/ajax/${myEmail}`, {
                method: "POST",
                headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                body: JSON.stringify({ message: msg, _subject: "Новый заказ (Portfolio Website)" })
            })
            .then(response => { if (response.ok) return response.json(); else throw new Error("Network error"); })
            .then(data => {
                btn.innerText = currentLang === 'ru' ? 'ОТПРАВЛЕНО!' : 'SENT!';
                btn.style.background = '#00ff88'; btn.style.color = '#000';
                document.getElementById('contact-msg').value = '';
                setTimeout(() => { toggleContact(); btn.disabled = false; btn.innerText = originalText; btn.style.background = ''; btn.style.color = ''; btn.style.opacity = "1"; }, 3000);
            })
            .catch(error => {
                window.location.href = `mailto:${myEmail}?subject=Motion Design Project&body=${encodeURIComponent(msg)}`;
                btn.disabled = false; btn.innerText = originalText; btn.style.opacity = "1";
            });
        }

function toggleContact() {
    const modal = document.getElementById('contact-modal');
    if (modal.style.display === 'flex') {
        modal.classList.remove('active');
        // Задержка перед скрытием, чтобы успела проиграться анимация (0.3s)
        setTimeout(() => { modal.style.display = 'none'; }, 300);
    } else {
        modal.style.display = 'flex';
        // Маленькая задержка перед добавлением класса для запуска CSS-анимации
        setTimeout(() => { modal.classList.add('active'); }, 10);
    }
	
}
function copyEmail() {
    navigator.clipboard.writeText(myEmail).then(() => {
        const btn = document.querySelector('.copy-btn');
        const originalText = btn.innerText;
        
        btn.innerText = currentLang === 'ru' ? 'СКОПИРОВАНО!' : 'COPIED!';
        btn.style.color = 'var(--accent-glow)';
        
        setTimeout(() => {
            btn.innerText = originalText;
            btn.style.color = '';
        }, 2000);
    });
}
        const translations = {
            ru: {
                "status": "Готов к работе", "hero-desc": "Соединяю искусство моушн-дизайна с генеративными нейросетями. Создаю визуальные миры, где технология обретает душу.",
                "back-btn": "← ВЕРНУТЬСЯ НАЗАД", "return-btn": "↓ ВЕРНУТЬСЯ К ПРОЦЕССУ", "lightbox-play-tpl": "СМОТРЕТЬ МОМЕНТ", 
                "copyright": "© 2026 Алексей Бережной", "contact-btn": "ОБСУДИТЬ ПРОЕКТ", "contact-title": "СВЯЗАТЬСЯ СО МНОЙ", "copy-btn": "КОПИРОВАТЬ",
                "contact-placeholder": "Опишите вашу задачу...", "send-btn": "ОТПРАВИТЬ ПИСЬМО"
            },
            en: {
                "status": "Open to create", "hero-desc": "Combining motion design art with generative neural networks. Creating visual worlds where technology gains a soul.",
                "back-btn": "← GO BACK", "return-btn": "↓ BACK TO PROCESS", "lightbox-play-tpl": "WATCH MOMENT",
                "copyright": "© 2026 Aleksej Berezhnoj", "contact-btn": "DISCUSS PROJECT", "contact-title": "CONTACT ME", "copy-btn": "COPY",
                "contact-placeholder": "Describe your task...", "send-btn": "SEND EMAIL"
            }
        };

        const projectsData = {
		'showreel': { title: { ru: 'Главный Шоурилл', en: 'Main Showreel' }, tag: 'VIDEO', steps: [] },
		'magic': {
                title: { ru: 'Единственная Стена это Ты', en: 'The Only Wall is You' },
                tag: 'AI Cinematic', 
                videoSrc: 'qw.mp4',
                steps: [
                    { 
                        num: '01', 
                        title: {ru: 'Концепт', en: 'Concept'},
ytLink: 'https://youtu.be/x2KRUP8mdRM?si=XglO13UBxYb5Fba7',						
                        sub: {ru: 'Moodboard & Prompt Engineering.', en: 'Moodboard & Prompt Engineering.'}, 
                        desc: {ru: `<b>MOODBOARD & STORYTELLING</b><br>
                            Разработка мудборта и референсов. Вначале пути была идея автомобиль в стилистике фильма трон - бекграунты фильма Интерстеллер и идея сценария о преодолении внутренних барьеров, где автомобиль — метафора движение человека преодолевающего трудности которые построил он сам в своей голове.<br><br>

<b>ANCHOR PROMPT ENGINEERING</b><br> 
Для визуальной целостности был разработан якорный промт, который позволил сохранить единую стилистику автомобиля и окружения на протяжении всего видеоряда.
Этот промт служил «визуальным cтолпом» проекта при работе с ИИ, гарантируя, что каждая генерация будет соответствовать заданным эстетическим параметрам:
Он жестко фиксировал материалы, освещение и детализацию, чтобы при смене ракурсов автомобиль оставался узнаваемым.`, en: `<b>MOODBOARD & STORYTELLING</b><br>
The journey began with the concept of a vehicle in the style of Tron, set against the vast backgrounds of Interstellar. The narrative explores the idea of overcoming internal barriers, where the car serves as a metaphor for a person moving through difficulties they have constructed within their own mind. To ensure visual integrity, an anchor prompt was developed, allowing for a consistent style for both the vehicle and the environment throughout the entire video sequence.<br><br>

<b>ANCHOR PROMPT ENGINEERING</b><br>
This prompt served as the project’s “visual DNA” when working with AI, ensuring that every generation adhered to the defined aesthetic parameters:

Fixed Visual Identity: The prompt strictly defined materials, lighting, and detailing.

Recognizability: This allowed the vehicle to remain recognizable across various camera angles and scene changes.

Aesthetic Continuity: It ensured that the fusion of sleek carbon fiber and neon accents remained consistent from start to finish..`}, 
                        img: ['miro.png', 'miro2.png'],
                    },
                    { num: '02', 
                        title: {ru: 'Генерация & Динамика', en: 'Generation & Dynamics'}, 
    sub: {ru: 'Google Veo, Klingai, NanaBanana, Grok, Claude, Gemini', en: 'Google Veo, Klingai, NanaBanana, Grok, Claude, Gemini'}, 
    desc: {
        ru: `<b>AI-DRIVEN PRODUCTION</b><br>
Переход от концепта к живой динамике. Google Veo и Klingai стали основными инструментами для генерации фотореалистичного движения. Grok, Gemini, Claude использовался для итеративной доработки промптов, что позволило добиться физически корректного поведения песка и частиц при пробуксовке колес, движение камеры,макросьемки и фокусного расстояния.<br><br>
<b>MATERIAL SYNTHESIS</b><br>
С помощью NanaBanana были синтезированы сложные материалы: многослойное углеволокно (carbon fiber) и адаптивное неоновое свечение. Это обеспечило визуальную глубину, где каждый блик на кузове подчеркивает аэродинамику гиперкара в движении.`, 
        en: `<b>AI-DRIVEN PRODUCTION</b><br>
Transitioning from static concepts to cinematic motion. Google Veo and Klingai served as the primary engines for generating photorealistic dynamics. Grok was used to iteratively refine prompts, achieving physically accurate behavior of sand and sparks during the burnout scenes.<br><br>
<b>MATERIAL SYNTHESIS</b><br>
Using NanaBanana, I synthesized complex materials, including multi-layered carbon fiber and adaptive neon lighting. This provided visual depth, where every reflection on the body highlights the hypercar's aerodynamics in motion.`
    }, 
    img: [
                            { src: 'step2.jpg', time: 12 },     // Первая картинка включает 12-ю секунду
                            { src: 'step2.2.png', time: 6 }    // Вторая картинка включает 5-ю секунду (поставьте нужное время)
                        ],
    time: 12,  }, 
	{ 
                        num: '03', 
                        title: {ru: 'Аудио-инжиниринг', en: 'Audio Engineering'}, 
                        sub: {ru: 'ElevenLabs, Pixabay & UVR', en: 'ElevenLabs, Pixabay & UVR'}, 
                        desc: {
                            ru: `<b>AI VOICEOVER & SFX LAYERING</b><br>
                            Голос рассказчика сгенерирован в <b>ElevenLabs</b>.<br>
                            Сложная звуковая картина (Soundscape) собрана из <b>более чем 60 отдельных аудио-слоев</b>: текстурные шумы, кинематографичные переходы (Whoosh), музыка и звуки двигателя с Pixabay.<br><br>
                            <b>MIXING</b><br>
                            Для интеграции и разделения на слои я использовал <b>UVR</b>, чтобы очистить частоты и идеально свести этот массив звуков.`, 
                            en: `<b>AI VOICEOVER & SFX LAYERING</b><br>
                            Narrator voice generated via <b>ElevenLabs</b>.<br>
                            The complex soundscape was constructed from <b>over 60 individual audio stems</b> sourced from Pixabay: ambient textures, cinematic whooshes, music bed, and engine SFX.<br><br>
                            <b>MIXING</b><br>
                            Used <b>UVR</b> to separate stems and clean frequencies, perfectly mixing this massive array of sounds with aggressive glitch transitions.`
                        }, 
                        img: 'step3.png', 
                         },
{ 
                        num: '04', 
                        title: {ru: 'VFX & UPSCALING', en: 'VFX & UPSCALING'}, 
                        sub: {ru: 'After Effects, Video2X', en: 'After Effects, Video2X'}, 
                        desc: {
                            ru: `<b>UPSCALING</b><br>
                            Использование <b>Video2X</b> для апскейла до 4K.<br><br>
                            <b>VFX INTEGRATION</b><br>
                            Процедурные эффекты в After Effects, плагины Video Copilot, saber и т.д. многочисленные маски и корректирующие слои. 
                            <b>COLOR CORRECTION</b><br>
                            Финальная цветокоррекция (Color Grading) для выравнивания тональности всех сцен и создания единой «холодной» кинематографичной атмосферы.`, 
                            en: `<b>UPSCALING</b><br>
                            Used <b>Video2X</b> for 4K upscaling.<br><br>
                            <b>VFX INTEGRATION</b><br>
                            Procedural effects in After Effects:
                            • <b>Optical Flares</b> for realistic headlights.<br>
                            • <b>Deep Glow</b> for soft cinematic bloom.<br>
                            • <b>Pixel Sorter</b> for the glitch transition.<br><br>
                            <b>COLOR CORRECTION</b><br>
                            Final color grading to match the tonality of all scenes and establish a unified "cold" cinematic atmosphere.`
                        }, 
                        sliders: [
                            { before: 'step44.png', after: 'step45.png', time: 28 }, // Прыгнет на 28 сек
                            { before: 'step5.png', after: 'step5.1.png', time: 45 }, // Прыгнет на 45 сек
                            { before: 'step6.png', after: 'step6.1.png', time: 40 }  // Прыгнет на 40 сек
                           
                        ],
                        time: 35 
                    }                       
                ],
            },
            'app': { title: { ru: 'Интерфейс Приложения', en: 'App Interface' }, tag: 'UI / UX Motion', videoSrc: 'watch.mp4', steps: [] },
            'woman': { 
                title: { ru: 'Реклама: Электронные Приглашения', en: 'Ad: Digital Invitations' }, 
                tag: 'AI + VFX Hybrid', 
                // ВАЖНО: Переименуйте файл в папке в promo.mp4 или исправьте тут на 'промо.mp4'
                videoSrc: 'promo.mp4', 
                steps: [
                    { 
                        num: '01', 
                        title: {ru: 'Генерация Персонажей и Сцены', en: 'Character & Scene Generation'}, 
                        sub: {ru: 'Nano Banana, Veo, Kling', en: 'Nano Banana, Veo, Kling'}, 
                        desc: {
                            ru: `<b>TEXT-TO-IMAGE</b><br>
                            Задача: создать теплую, уютную атмосферу "мамы и ребенка" в кафе. С помощью <b>Nano Banana</b> были сгенерированы стилистически выверенные изображения персонажей.<br><br>
                            <b>IMAGE-TO-VIDEO</b><br>
                            Статичные изображения были "оживлены" с помощью нейросетей <b>Veo</b> и <b>Kling</b>. Написаны сложные промты для сохранения консистентности лиц при движении. Были созданы базовые шоты: рисование, эмоции, использование телефона.`,
                            
                            en: `<b>TEXT-TO-IMAGE</b><br>
                            Objective: create a warm, cozy atmosphere of "mom and child" in a cafe. Using <b>Nano Banana</b>, characters were generated with precise stylistic control.<br><br>
                            <b>IMAGE-TO-VIDEO</b><br>
                            Static images were brought to life using <b>Veo</b> and <b>Kling</b> AI models. Complex prompts were written to maintain facial consistency during motion. 4 base shots were created: drawing, emotions, phone usage.`
                        },
                        // Замените имена файлов на реальные картинки из папки images
                        media: [ { type: 'image', src: 'woman1.jpg', time: 1 },
						         { type: 'image', src: 'woman3.png', time: 3 },
							    { type: 'image', src: 'woman2.png', time: 13 }, ]
                    },
					{ 
                        num: '02', // Не забудьте поменять номера у следующих шагов (03, 04...)
                        title: {ru: 'Создание Анимированной Открытки', en: 'Animated Card Creation'}, 
                        sub: {ru: 'Freepik, Illustrator, After Effects', en: 'Freepik, Illustrator, After Effects'}, 
                        desc: {
                            ru: `<b>VECTOR PREP</b><br>
                            На <b>Freepik</b> было подобрано векторное изображение, сгенерированное ИИ. В <b>Adobe Illustrator</b> произведена адаптация размера под мобильный формат, а каждый слой был разделен и структурирован для корректного экспорта.<br><br>
                            <b>PUPPET ANIMATION</b><br>
                            В <b>After Effects</b> собрана финальная сцена и добавлена типографика. Произведена анимация персонажей и объектов с помощью инструмента <b>Puppet Pin</b>, наложены эффекты для оживления статики.`,
                            
                            en: `<b>VECTOR PREP</b><br>
                            An AI-generated vector image was sourced from <b>Freepik</b>. In <b>Adobe Illustrator</b>, the layout was resized for mobile, and layers were separated and structured for export.<br><br>
                            <b>PUPPET ANIMATION</b><br>
                            Scene assembly and typography added in <b>After Effects</b>. Characters and objects were animated using the <b>Puppet Pin</b> tool, with effects applied to bring the static illustration to life.`
                        },
                        media: [
						{ type: 'image', src: 'woman7.png'},
						{ type: 'image', src: 'woman6.png'},
                            { 
                                type: 'video', 
                                src: 'images/Comp_1.mp4', // <--- ЗАМЕНИТЕ НА ВАШ ФАЙЛ С ОТКРЫТКОЙ
                                autoplay: true, 
                                fit: 'contain', // Чтобы открытка влезла целиком
                                ratio: '9/16',  // Вертикальная пропорция
                                width: '40%'    // Ограничение ширины для красоты
                            },
                        ]
                    },
                    { 
                        num: '03', // Проверьте номер шага (если добавили предыдущий про вектор, этот будет 03)
                        title: {ru: 'VFX: Трекинг Экрана', en: 'VFX: Screen Tracking'}, 
                        sub: {ru: 'Mocha Pro, After Effects, Photoshop', en: 'Mocha Pro, After Effects, Photoshop'}, 
                        desc: {
                            ru: `<b>UI & MOCKUP CREATION</b><br>
                            Макет интерфейса мобильного приложения был подготовлен в <b>Photoshop</b>, итоговая собрка, анимация и микровзаимодействий подготовлена в <b>After Effects</b> для последующей интеграции.<br><br>
                            
                            <b>SCREEN REPLACEMENT</b><br>
                            В сгенерированном ИИ видео на экране телефона был промтом прописан хромакей. Для интеграции реального продукта (электронного приглашения) использовался <b>Mocha Pro</b>.<br><br>

                            <b>COMPOSITING</b><br>
                            Выполнен планарный трекинг (Planar Tracking) поверхности телефона. Поверх наложено видео с дизайном открытки. Добавлены реалистичные отражения, зерно и цветокоррекция, чтобы экран выглядел частью исходного видео, а не "наклейкой".`,
                            
                            en: `<b>UI & MOCKUP CREATION</b><br>
                            The mobile app interface mockup was assembled in <b>Photoshop</b>, with scroll animation and micro-interactions prepared in <b>After Effects</b> for integration.<br><br>

                            <b>SCREEN REPLACEMENT</b><br>
                            The AI-generated video featured a chroma key screen via prompt engineering. <b>Mocha Pro</b> was used to integrate the real product (digital invitation).<br><br>

                            <b>COMPOSITING</b><br>
                            Performed planar tracking of the phone surface. Overlayed the invitation design video. Added realistic reflections, grain, and color matching to ensure the screen looked like part of the original footage.`
                        },
                        media: [
                            // Если у вас есть слайдер До/После для экрана, оставьте его здесь
							{ type: 'image', src: 'woman8.png', time: 6 },
                            { type: 'slider', before: 'woman4.png', after: 'woman5.png', time: 9 },
							{ 
                                type: 'video', 
                                src: 'images/comp_2.mp4', // <--- ЗАМЕНИТЕ НА ВАШ ФАЙЛ С ОТКРЫТКОЙ
                                autoplay: true, 
                                fit: 'contain', // Чтобы открытка влезла целиком
                                ratio: '9/16',  // Вертикальная пропорция
                                width: '40%'    // Ограничение ширины для красоты
                            }
                        ]
                    },
                    { 
                        num: '04', 
                        title: {ru: 'Монтаж и Саунд-дизайн', en: 'Editing & Sound Design'}, 
                        sub: {ru: 'After Effects, Premiere', en: 'After Effects, Premiere'}, 
                        desc: {
                            ru: `<b>EDITING & TYPOGRAPHY</b><br>
                            Финальная сборка сцен в единый ролик. Добавлены переходы и текстовые плашки "Детство мимолетно" с анимацией появления.<br><br>
                            <b>SOUNDSCAPE</b><br>
                            Подбор и сведение музыкального сопровождения для усиления эмоционального отклика целевой аудитории (родителей).`,
                            
                            en: `<b>EDITING & TYPOGRAPHY</b><br>
                            Final assembly of scenes into a cohesive video. Added transitions and text overlays "Childhood is fleeting" with entrance animation.<br><br>
                            <b>SOUNDSCAPE</b><br>
                            Selection and mixing of background music to enhance the emotional response of the target audience (parents).`
                        },
                        media: [ { type: 'image', src: 'woman9.png'},
                        { type: 'image', src: 'woman10.png' },
						{ type: 'image', src: 'woman11.png'}]
                    }
                ]
            }, 
            'watch': { title: { ru: 'Luxury Watch', en: 'Luxury Watch' }, tag: 'Cinema 4D', videoSrc: 'watch.mp4',
                steps: [
                    { 
                        num: '01', 
                        title: {ru: 'Начало пайплайна КОНЦЕПТ', en: 'Start of the pipeline CONCPET'}, 
                        sub: {ru: 'Miro, Сценарий', en: 'Miro, Scenario'}, 
                        desc: {
                            ru: `<b>Бриф, мудборд, референсы</b><br>
                            На основе брифа в Miro был проработан полный цикл пре-продакшна: от поиска визуальных референсов и создания мудборда, задающего атмосферу, до подбора музыкального сопровождения.<br><br>
                            <b>Сценарий</b><br>
                           Детализированный сценарий (9 сцен), включающий шот-лист, точный хронометраж и описание внутрикадровой динамики. Для каждого эпизода подготовлены финальные шоты, демонстрирующие визуальное решение.»`, 
                            en: `<b>Brief, moodboard, scene storyboard</b><br>
                            Based on the brief, Miro worked through the full pre-production cycle: from searching for visual references and creating a mood board to set the atmosphere, to selecting the musical accompaniment.<br><br>
                            <b>Scenario</b><br>
                            A detailed script (9 scenes), including a shot list, precise timing, and a description of the in-frame dynamics. Final shots demonstrating the visual solution were prepared for each episode.`
                        }, 
                        img: ['Watch1.png',],
						sliders: [
                            { before: 'Watch2.png', after: 'Watch3.png' } // Замените на свои имена файлов
                        ],
                    },
                    { 
                        num: '02', 
                        title: {ru: 'Аниматик', en: 'Animatic'}, 
                        sub: {ru: 'Cinema 4D, Аниматик', en: 'Cinema 4D, Animatic'}, 
                        desc: {
                            ru: `<b>Аниматик</b><br>
                            По сценарию в Cinema4D был собран аниматик. Это позволило полностью выстроить движение камер и анимацию объектов, утвердить монтажный ритм и переходы еще до этапа текстурирования.<br><br>
                            <b>Models, Texture, Gobos, PBR Materials, HDRI</b><br>
                            Модель часов была доработана PBR Материалами, добавлены текстуры кожи, неровностей, стекла. Многочисленная настройка источников света как точеченых так и для общего окружения сцены HDRI картами, использование Gobos для проецирования теней. Для поиска тестур и материалов использовались polyhaven, quixel.`,							
                            en: `<b>Animatic</b><br>
                            An animatic was created using the script in Cinema4D. This allowed us to fully align camera movements and object animations, and confirm the editing rhythm and transitions before the texturing stage.<br><br>
                            <b>Models, Texture, Gobos, PBR Materials, HDRI</b><br>
                            The watch model was refined with PBR materials, adding leather, bump, and glass textures. Numerous light source adjustments were made, both for point lighting and for the overall scene environment using HDRI maps, and Gobos were used for shadow projection. Polyhaven and Quixel were used for texture and material searches.`
                        }, 
                        media: [
                          // --- ВИДЕО ---
                           { 
                             type: 'video', 
                              src: 'images/watch4.mp4', 
                              autoplay: true // true = само играет без звука, false = плеер с кнопками
                             },
                          // Слайдер
                          { type: 'slider', before: 'whatch5.png', after: 'whatch6.png'}
                          ]
                    },
                    { 
                        num: '03', 
                        title: {ru: 'Физика и работа с камерой', en: 'Camera and Physics'}, 
                        sub: {ru: 'Dynamics', en: 'Dynamics'}, 
                        desc: {
                            ru: `<b>PHYSICS & SIMULATION</b><br>
                            Тонкая настройка физики твердых тел (Rigid Body Dynamics) для реалистичного взаимодействия деталей механизма, использование Mograph и работа с силами Attractor, Rotation, Gravity, Wind и т.д., позволили добится динамичного взаимодействия между обьектов. Так например был реализован поток из осколков обваливающийся на часы, за пределами обзора камеры помещался объект с Voronoi Fracture, на него воздействовал Rotation разбивая его на сегметы и далее работал Attractor размещенный у часов, предварительно в сцене была убрана гравитация.<br><br>
                            <b>Cinematic Fly-Throughs</b><br>
                            Работа с камерой: выстроены плавные, пролеты. Работа с кривыми интерполяции (F-Curves) для исключения резких рывков.<br><br>
                            <b>DYNAMIC TRACKING</b><br>
                            Реализовано динамичное движение камеры, следующей за объектами (Target Tracking).`, 
                            en: `<b>PHYSICS & SIMULATION</b><br>
                            Fine-tuning Rigid Body Dynamics for realistic interactions between mechanism parts, using Mograph, and working with Attractor, Rotation, Gravity, Wind, and other forces, enabled dynamic interactions between objects. For example, a stream of fragments collapsing onto a watch was realized. An object with a Voronoi Fracture was placed outside the camera's field of view, broken into segments by Rotation, and then an Attractor placed near the watch was applied. Gravity was removed from the scene beforehand. <br><br>
                            <b>Cinematic Fly-Throughs</b><br>
                            Camera interaction: smooth fly-throughs were created. Interpolation curves (F-Curves) were used to eliminate sharp jerks. <br><br>
                            <b>DYNAMIC TRACKING</b><br>
                            Dynamic camera movement was implemented, following objects (Target Tracking).`
                        },
                        media: [
                            // 1. Картинка
                            { type: 'image', src: 'whatch7.png', time: 19 },
							{ type: 'image', src: 'whatch8.png', time: 23 },
							{ type: 'image', src: 'whatch9.png', time: 35 },
                        ],
                    },
                    { 
                        num: '04', 
                        title: {ru: 'Финал пайплайна Rendering, Compositing', en: 'Rendering, Compositing'}, 
                        sub: {ru: 'After Effects', en: 'After Effects'}, 
                        desc: {
                            ru: `<b>REDSHIFT</b><br>
                            Финальный рендеринг выполнен в <b>Redshift</b>. Использование AOVs (Multipass) дало гибкость в настройке отражений и света на этапе поста.<br><br>
                            <b>COMPOSITING & SOUND</b><br>
                            Финальная сборка (Compositing) в <b>After Effects</b>: цветокоррекция (Color Grading), добавление оптических эффектов (Glow, Glare) и саунд-дизайн. Музыкальный трек синхронизирован с ключевыми моментами анимации для усиления эмоционального воздействия.`, 
                            en: `<b>POST-PRODUCTION</b><br>
                            Final assembly in <b>After Effects</b>. Color grading, adding soft glow to neon elements, and contrast enhancement.<br><br>
                            <b>EDITING & SOUND</b><br>
                            Rhythmic editing synchronized with music and sound design (SFX) to reinforce the feeling of weight and material quality.`
                        }, 
                        media: [
                            // Слайдер
                          { type: 'slider', before: 'whatch10.jpg', after: 'whatch11.png', time: 3},
                          { type: 'slider', before: 'whatch12.png', after: 'whatch13.png', time: 20},
						  { type: 'slider', before: 'whatch14.png', after: 'whatch15.png', time: 45},
                        ], 
                    }
                ]}
        };

        function setLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.querySelector(`.lang-btn[onclick="setLanguage('${lang}')"]`);
            if(activeBtn) activeBtn.classList.add('active');
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) el.innerText = translations[lang][key];
            });
            document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                const key = el.getAttribute('data-i18n-placeholder');
                if (translations[lang][key]) el.placeholder = translations[lang][key];
            });
            if (currentProjectId) openProject(currentProjectId, false);
        }

        const mainView = document.getElementById('main-view');
        const projectView = document.getElementById('project-view');
        const processContainer = document.getElementById('process-container');

        function openProject(id, scrollToTop = true) {
            currentProjectId = id;
            const data = projectsData[id];
            
            document.getElementById('p-title').innerText = data.title[currentLang] || data.title['en'];
            document.getElementById('p-tag').innerText = data.tag;
            
            if(data.videoSrc && pVideo.getAttribute('src') !== data.videoSrc) {
                pVideo.src = data.videoSrc; pVideo.style.display = 'block';
            } else if (!data.videoSrc) { pVideo.style.display = 'none'; }

            processContainer.innerHTML = '';
            
            if (data.steps) {
                data.steps.forEach((step, index) => {
                    const title = step.title[currentLang];
                    const sub = step.sub[currentLang];
                    const desc = step.desc[currentLang];
                    
                    let contentHTML = '';

                    // === ЕДИНЫЙ СПИСОК MEDIA (С ПОДДЕРЖКОЙ ВИДЕО) ===
                    if (step.media) {
                        step.media.forEach((item, i) => {
                            const itemTime = item.time !== undefined ? item.time : (step.time || 0);

                            if (item.type === 'slider') {
                                // --- СЛАЙДЕР ---
                                contentHTML += `
                                <div id="step-${index}-m${i}" class="process-card compare-card" onclick="openLightbox('${item.after}', ${itemTime}, 'step-${index}-m${i}', '${item.before}')">
                                    <div class="compare-container">
                                        <div class="label label-before">RAW</div>
                                        <img src="images/${item.before}" class="compare-img">
                                        <div class="img-after-wrapper">
                                            <div class="label label-after">FINAL</div>
                                            <img src="images/${item.after}" class="compare-img">
                                        </div>
                                    </div>
                                </div>`;
                            } else if (item.type === 'video') {
    const videoAttrs = item.autoplay 
        ? 'autoplay loop muted playsinline' 
        : 'controls playsinline';
    
    // Если в данных написано fit: 'contain', используем его. Иначе по умолчанию 'cover'
    const objectFit = item.fit || 'cover'; 

    contentHTML += `
    <div style="position: relative; width: 100%;" id="step-${index}-m${i}">
        <div class="process-card" style="cursor: default; pointer-events: auto;">
            <video src="${item.src}" ${videoAttrs} 
                style="width: 100%; height: 100%; object-fit: ${objectFit}; border-radius: 12px; display: block; background: #000;">
            </video>
        </div>
    </div>`;
}
                            else {
                                // --- КАРТИНКА ---
                                contentHTML += `
                                <div style="position: relative; width: 100%;" id="step-${index}-m${i}">
                                    <div class="process-card" onclick="openLightbox('${item.src}', ${itemTime}, 'step-${index}-m${i}')">
                                        <img src="images/${item.src}" class="process-img">
                                    </div>
                                </div>`;
                            }
                        });
                    } 
                    // === СТАРАЯ ЛОГИКА (Если media нет, ищем по старинке) ===
                    else {
                        if (Array.isArray(step.img)) {
                            step.img.forEach((item, i) => {
                                const isObject = typeof item === 'object';
                                const src = isObject ? item.src : item;
                                const itemTime = isObject && item.time !== undefined ? item.time : (step.time || 0);
                                contentHTML += `<div style="position: relative; width: 100%;" id="step-${index}-f${i}"><div class="process-card" onclick="openLightbox('${src}', ${itemTime}, 'step-${index}-f${i}')"><img src="images/${src}" class="process-img"></div></div>`;
                            });
                        } else if (step.img) {
                            contentHTML += `<div class="process-card" onclick="openLightbox('${step.img}', ${step.time || 0}, 'step-${index}')"><img src="images/${step.img}" class="process-img"></div>`;
                        }
                        if (step.sliders) {
                            step.sliders.forEach((s, i) => {
                                const itemTime = s.time !== undefined ? s.time : (step.time || 0);
                                contentHTML += `<div id="step-${index}-s${i}" class="process-card compare-card" onclick="openLightbox('${s.after}', ${itemTime}, 'step-${index}-s${i}', '${s.before}')"><div class="compare-container"><div class="label label-before">RAW</div><img src="images/${s.before}" class="compare-img"><div class="img-after-wrapper"><div class="label label-after">FINAL</div><img src="images/${s.after}" class="compare-img"></div></div></div>`;
                            });
                        }
                    }

                    const visualHTML = `<div class="vertical-stack">${contentHTML}</div>`;
                    
                    let ytButtonHTML = '';
                    if (step.ytLink) {
                        ytButtonHTML = `
                            <a href="${step.ytLink}" target="_blank" class="yt-button">
                                <svg class="yt-icon" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
                                ${currentLang === 'ru' ? 'Видео в 4К' : 'WATCH ON 4K'}
                            </a>`;
                    }

                    const html = `
                        <div class="timeline-step" id="step-${index}">
                            <div class="timeline-dot"></div>
                            <div class="step-text">
                                <div class="step-number">${step.num}</div>
                                ${ytButtonHTML}
                                <h3>${title}</h3>
                                <h4>${sub}</h4>
                                <p>${desc}</p>
                            </div>
                            <div class="step-visual">${visualHTML}</div>
                        </div>
                    `;
                    processContainer.insertAdjacentHTML('beforeend', html);
                });
                initCards(); initComparisons();
            }

            mainView.style.display = 'none';
            projectView.style.display = 'block';
            
            if(data.videoSrc && pVideo.paused) {
                pVideo.muted = false; pVideo.volume = 0.4;
                const playPromise = pVideo.play();
                if (playPromise !== undefined) playPromise.catch(e => console.log("Auto-blocked"));
            }
            if(scrollToTop) window.scrollTo(0,0);
            setTimeout(() => { projectView.style.opacity = '1'; projectView.style.animation = 'fadeIn 0.5s ease forwards'; }, 10);

            // ЗАПУСКАЕМ СЧЕТЧИК (+1 просмотр) СКРЫТО
            updateViewCount(id);
        }

        function showMain() {
            currentProjectId = null;
            pVideo.pause(); pVideo.currentTime = 0;
            projectView.style.opacity = '0';
            setTimeout(() => { projectView.style.display = 'none'; mainView.style.display = 'block'; }, 300);
        }

        function initCards() {
            const cards = document.querySelectorAll('.process-card');
            cards.forEach(card => {
                card.addEventListener('mousemove', (e) => {
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left; 
                    const y = e.clientY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = ((y - centerY) / centerY) * -10; 
                    const rotateY = ((x - centerX) / centerX) * 10;  
                    card.style.transform = `scale(1.05) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
                });
                card.addEventListener('mouseleave', () => { card.style.transform = 'scale(1) rotateX(0) rotateY(0)'; });
            });
        }

        function initComparisons() {
    const wrappers = document.querySelectorAll('.compare-card');
    wrappers.forEach(card => {
        const container = card.querySelector('.compare-container');
        const afterWrapper = card.querySelector('.img-after-wrapper');
        const afterImg = afterWrapper.querySelector('.compare-img');
        
        // Фикс ширины
        const updateWidth = () => { afterImg.style.width = container.offsetWidth + 'px'; };
        setTimeout(updateWidth, 100);

        const move = (e) => {
            if (e.type === 'touchmove') e.preventDefault(); // ОСТАНАВЛИВАЕМ СКРОЛЛ БРАУЗЕРА
            const rect = container.getBoundingClientRect();
            let x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
            if (x < 0) x = 0; if (x > rect.width) x = rect.width;
            afterWrapper.style.width = x + 'px';
        };

        card.addEventListener('mousemove', move);
        card.addEventListener('touchmove', move, {passive: false}); // passive: false позволяет preventDefault
    });
}

function initLightboxSlider() {
    const container = document.getElementById('lightbox-compare-box');
    const afterWrapper = document.getElementById('lb-after-wrapper');
    const afterImg = document.getElementById('lb-img-after');

    const move = (e) => {
        if (e.cancelable) e.preventDefault(); // ГЛАВНЫЙ ФИКС ОТ ПЛАВАНИЯ
        const rect = container.getBoundingClientRect();
        let x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
        if (x < 0) x = 0; if (x > rect.width) x = rect.width;
        afterWrapper.style.width = x + 'px';
    };

    container.addEventListener('mousemove', move);
    container.addEventListener('touchmove', move, {passive: false});
}

window.addEventListener('resize', () => {
    // Принудительно обновляем ширину внутреннего фото в слайдере лайтбокса
    const compareBox = document.getElementById('lightbox-compare-box');
    const imgAfter = document.getElementById('lb-img-after');
    if (compareBox && imgAfter) {
        imgAfter.style.width = compareBox.offsetWidth + 'px';
    }
});

          function openLightbox(src, time = 0, stepId = '', beforeSrc = '') {
            activeStepId = stepId;
            document.body.classList.add('modal-open');
            
            const compareBox = document.getElementById('lightbox-compare-box');
            const imgNormal = document.getElementById('lightbox-img');
            const lbImgBefore = document.getElementById('lb-img-before');
            const lbImgAfter = document.getElementById('lb-img-after');
            const afterWrapper = document.getElementById('lb-after-wrapper');

            if (beforeSrc) {
                imgNormal.style.display = 'none';
                compareBox.style.display = 'block';
                
                lbImgBefore.src = 'images/' + beforeSrc;
                lbImgAfter.src = 'images/' + src;

                // ФИКС: Устанавливаем точную ширину в пикселях
                const syncSizes = () => {
                    const boxWidth = compareBox.offsetWidth;
                    if (boxWidth > 0) {
                        lbImgBefore.style.width = boxWidth + 'px';
                        lbImgAfter.style.width = boxWidth + 'px';
                        afterWrapper.style.width = '50%';
                    }
                };
                
                // Запускаем через паузу, чтобы браузер успел отрисовать модалку
                setTimeout(syncSizes, 150);

            } else {
                compareBox.style.display = 'none';
                imgNormal.style.display = 'block'; 
                imgNormal.src = 'images/' + src;
            }
            
            const playBtn = document.getElementById('lightbox-play-btn');
            if(time > 0) { 
                playBtn.style.display = 'flex'; 
                playBtn.onclick = () => jumpToVideo(time); 
            } else { 
                playBtn.style.display = 'none'; 
            }
            
            lightbox.style.display = 'flex'; 
            setTimeout(() => lightbox.classList.add('active'), 10);
        }

function closeLightbox() {
    // Разблокируем скролл
    document.body.classList.remove('modal-open');
    lightbox.classList.remove('active');
    setTimeout(() => { lightbox.style.display = 'none'; }, 300);
}
        function jumpToVideo(time) {
            closeLightbox();
            document.querySelector('.video-wrapper').scrollIntoView({behavior: 'smooth', block: 'center'});
            pVideo.currentTime = time; pVideo.play(); pVideo.muted = false;
            returnBtn.classList.add('active');
        }
        function returnToStep() {
            pVideo.pause(); returnBtn.classList.remove('active');
            if(activeStepId) { document.getElementById(activeStepId)?.scrollIntoView({behavior: 'smooth', block: 'center'}); }
        }

        // --- ЛОГИКА АДМИНКИ И СЧЕТЧИКА ---
        const namespace = 'aleksey-portfolio';
        const adminModal = document.getElementById('admin-modal');
        const adminLoginView = document.getElementById('admin-login-view');
        const adminStatsView = document.getElementById('admin-stats-view');
        const statsList = document.getElementById('stats-list-container');
        const adminPassInput = document.getElementById('admin-pass');
        
        // ПРАВИЛЬНЫЙ ХЭШ ДЛЯ ПАРОЛЯ "108"
        const SECRET_HASH = "9537f32ec7599e1ae953af6c9f929fe747ff9dadf79a9beff1f304c550173011";

        function toggleAdmin() {
            if(adminModal.style.display === 'flex') {
                adminModal.classList.remove('active'); setTimeout(() => { adminModal.style.display = 'none'; }, 300);
            } else {
                adminModal.style.display = 'flex'; setTimeout(() => { adminModal.classList.add('active'); }, 10);
                adminLoginView.style.display = 'block';
                adminStatsView.style.display = 'none';
                adminPassInput.value = '';
            }
        }

        async function checkAdminPassword() {
            const input = adminPassInput.value.trim(); // ДОБАВИЛИ TRIM ДЛЯ ПРЕДОТВРАЩЕНИЯ ОШИБОК С ПРОБЕЛАМИ
            const msgBuffer = new TextEncoder().encode(input);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');

            if (hashHex === SECRET_HASH) {
                adminLoginView.style.display = 'none';
                adminStatsView.style.display = 'block';
                loadAdminStats();
            } else {
                alert('ACCESS DENIED');
                adminPassInput.value = '';
            }
        }

        function loadAdminStats() {
            statsList.innerHTML = '<div style="text-align:center; color:#888;">Fetching data...</div>';
            const promises = [];

            for (let key in projectsData) {
                const projectTitle = projectsData[key].title['en']; 
                // Запрос к новому сервису
                const p = fetch(`https://api.counterapi.dev/v1/projects/${namespace}/counters/${key}`)
                    .then(res => res.json())
                    .then(data => {
                        // В новом сервисе число лежит в data.count, а не в data.value
                        return { title: projectTitle, val: data.count || 0 };
                    })
                    .catch(() => { return { title: projectTitle, val: 0 }; });
                promises.push(p);
            }

            Promise.all(promises).then(results => {
                statsList.innerHTML = '';
                results.forEach(item => {
                    statsList.innerHTML += `
                        <div class="stat-row">
                            <span class="stat-name">${item.title}</span>
                            <span class="stat-val">${item.val}</span>
                        </div>
                    `;
                });
            });
        }

        // Функция для накрутки при просмотре пользователем (ТЕПЕРЬ ТИХАЯ)
        function updateViewCount(projectId) {
            // Эндпоинт /up создаст счетчик автоматически при первом клике
            fetch(`https://api.counterapi.dev/v1/projects/${namespace}/counters/${projectId}/up`)
                .then(res => res.json())
                .then(data => console.log('Просмотр засчитан:', data.count))
                .catch(err => console.log('Счетчик инициализируется...'));
        }

        const canvas = document.getElementById('neural-canvas');
        const ctx = canvas.getContext('2d');
        let width, height; let particles = [];
        let properties = {};
        
        // 1. Умные настройки (светлее и меньше на мобильном)
        function updateProperties() {
            const isMobile = window.innerWidth < 768;
            properties = {
                particleColor: isMobile ? 'rgba(255, 255, 255, 0.15)' : 'rgba(255, 255, 255, 0.5)',
                lineColor: 'rgba(0, 240, 255,',
                particleCount: isMobile ? 30 : 70, // 30 на телефоне, 70 на ПК
                connectionDistance: isMobile ? 100 : 150,
                lineOpacityFactor: isMobile ? 0.3 : 1
            };
        }

        function resize() { 
            width = canvas.width = window.innerWidth; 
            height = canvas.height = window.innerHeight; 
            updateProperties(); // Обновляем при перевороте экрана
            init(); 
        }
        
        window.addEventListener('resize', () => {
    const compareBox = document.getElementById('lightbox-compare-box');
    if (compareBox && compareBox.style.display === 'block') {
        const imgBefore = document.getElementById('lb-img-before');
        const imgAfter = document.getElementById('lb-img-after');
        
        const newWidth = compareBox.offsetWidth;
        imgBefore.style.width = newWidth + 'px';
        imgAfter.style.width = newWidth + 'px';
    }
});; 

        class Particle {
            constructor() { 
                this.x = Math.random() * width; 
                this.y = Math.random() * height; 
                this.vx = (Math.random() - 0.5) * 0.5; 
                this.vy = (Math.random() - 0.5) * 0.5; 
                const isMobile = window.innerWidth < 768;
                this.size = Math.random() * (isMobile ? 1.5 : 2) + 1; 
            }
            update() { 
                this.x += this.vx; this.y += this.vy; 
                if (this.x < 0 || this.x > width) this.vx *= -1; 
                if (this.y < 0 || this.y > height) this.vy *= -1; 
            }
            draw() { 
                ctx.beginPath(); 
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2); 
                ctx.fillStyle = properties.particleColor; 
                ctx.fill(); 
            }
        }
        
        function init() { 
            updateProperties();
            particles = []; 
            for (let i = 0; i < properties.particleCount; i++) { 
                particles.push(new Particle()); 
            } 
        }
        
        function animate() {
            ctx.clearRect(0, 0, width, height);
            for (let i = 0; i < particles.length; i++) {
                particles[i].update(); particles[i].draw();
                for (let j = i; j < particles.length; j++) {
                    let dx = particles[i].x - particles[j].x; 
                    let dy = particles[i].y - particles[j].y; 
                    let distance = Math.sqrt(dx*dx + dy*dy);
                    if (distance < properties.connectionDistance) {
                        // Учитываем фактор прозрачности для мобильных
                        let opacity = (1 - (distance / properties.connectionDistance)) * properties.lineOpacityFactor;
                        ctx.strokeStyle = properties.lineColor + opacity + ')'; 
                        ctx.lineWidth = 1;
                        ctx.beginPath(); 
                        ctx.moveTo(particles[i].x, particles[i].y); 
                        ctx.lineTo(particles[j].x, particles[j].y); 
                        ctx.stroke();
                    }
                }
            }
            requestAnimationFrame(animate);
        }
        resize(); // Запускаем при старте
        // 1. Слушаем скролл сайта
        window.addEventListener('scroll', function() {
            const btn = document.getElementById('scrollTopBtn');
			const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolled = (winScroll / height) * 100;
    document.querySelector(".scroll-progress").style.width = scrolled + "%";
            // Если прокрутили больше 300px, добавляем класс show
            if (window.scrollY > 300) {
                btn.classList.add('show');
            } else {
                btn.classList.remove('show');
            }
        });

        // 2. Функция, которая крутит вверх при клике
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth' // Плавная прокрутка
            });
        }
		// --- ЛОГИКА ПРЕЛОАДЕРА (ИСПРАВЛЕННАЯ) ---
        function hidePreloader() {
            const preloader = document.getElementById('preloader');
            if (preloader) {
                preloader.classList.add('hide');
                // Удаляем из кода совсем, чтобы можно было кликать по сайту
                setTimeout(() => { preloader.style.display = 'none'; }, 1000);
            }
        }

        // Вариант 1: Если сайт загрузился быстро
        window.addEventListener('load', () => {
            setTimeout(hidePreloader, 1000); 
        });

        // Вариант 2: СТРАХОВКА. Если сайт завис (видео не грузится), 
        // убираем экран принудительно через 3 секунды
        setTimeout(hidePreloader, 3000);

        // 2. Эффект увеличения при наведении на активные элементы
        // Ищем все ссылки, кнопки и карточки
        const interactiveElements = document.querySelectorAll('a, button, .card, .contact-float, .social-icon');
        
        interactiveElements.forEach(el => {
            el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
            el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
        });
        init(); animate(); initCards(); initLightboxSlider(); initComparisons(); setLanguage('ru');
		// --- СКРИПТ ЖИВОГО НЕЙРО-ПРОЦЕССА ---
function animateNeuralLock() {
    const percentEl = document.getElementById('neural-percent');
    if (!percentEl) return;

    let basePercent = 88.2; // Стартовый процент

    setInterval(() => {
        // Создаем небольшое случайное колебание (имитация реального вычисления)
        let fluctuation = (Math.random() * 0.4 - 0.2); // от -0.2 до +0.2
        let currentDisplay = (basePercent + fluctuation).toFixed(1);
        
        // Иногда (в 5% случаев) имитируем "скачок" или глитч
        if (Math.random() > 0.95) {
            percentEl.style.textShadow = "0 0 15px var(--accent-glow)";
            setTimeout(() => percentEl.style.textShadow = "", 100);
        }

        percentEl.innerText = currentDisplay;
    }, 150); // Частота обновления в мс
}

// Запускаем при загрузке
animateNeuralLock();


// Запрет контекстного меню (правой кнопки мыши)
document.addEventListener('contextmenu', (e) => {
    e.preventDefault();
});

document.addEventListener('keydown', (e) => {
    // Запрет F12, Ctrl+Shift+I (инспектор), Ctrl+U (исходный код)
    if (
        e.key === 'F12' || 
        (e.ctrlKey && e.shiftKey && e.key === 'I') || 
        (e.ctrlKey && e.key === 'u') ||
        (e.ctrlKey && e.key === 'U')
    ) {
        e.preventDefault();
        return false;
    }
});

window.addEventListener('resize', () => {
    const compareBox = document.getElementById('lightbox-compare-box');
    if (compareBox && compareBox.style.display === 'block') {
        const imgBefore = document.getElementById('lb-img-before');
        const imgAfter = document.getElementById('lb-img-after');
        const afterWrapper = document.getElementById('lb-after-wrapper');

        // Функция пересчета
        const fixSizes = () => {
            const newWidth = compareBox.offsetWidth;
            imgBefore.style.width = newWidth + 'px';
            imgAfter.style.width = newWidth + 'px';
            // Возвращаем ползунок в центр, чтобы не "улетал"
            afterWrapper.style.width = '50%';
        };

        fixSizes();
        // Повторяем через 200мс, так как iPhone меняет размер с анимацией
        setTimeout(fixSizes, 200);
    }
});

// Фикс для корректной работы тач-слайдера без плавания страницы
document.getElementById('lightbox-compare-box').addEventListener('touchmove', function(e) {
    if (e.cancelable) e.preventDefault(); 
}, { passive: false });

// Установка громкости для видео в футере на 50%
document.addEventListener('DOMContentLoaded', () => {
        const mainShowreel = document.querySelector('.showreel-video');
        if (mainShowreel) {
            mainShowreel.volume = 0.3; // Громкость 50%
            mainShowreel.addEventListener('play', () => {
                updateViewCount('showreel');
            }, { once: true });
        }
    });

    </script>
</body>
</html>
